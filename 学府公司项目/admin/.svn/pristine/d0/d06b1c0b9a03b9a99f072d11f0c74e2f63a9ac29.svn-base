<div style="padding-top: 13px">
    <div class="col-md-12">
        <div class="padding-l-10 f-s-17 bod  box-s bod-r-8 padding-t-10">
            <a class="btn btn-e btn-wd" href="#/muchadd" >创建站点</a>
            <button class="btn  btn-f btn-wd" onclick="deleteclass()">批量禁用</button>
        </div>
    </div>

    <div class="container-fluid padding-t-20">
        <div class="row">
            <div class="col-md-12 ">
                <table class="table table-bordered table-hover" id="tablecz">
                    <thead>
                    <tr>
                        <th><input class="fuxk" name="allcheck" type="checkbox" value="" id="allcheck" onclick="selectall(this)"/></th>
                        <th class="text-center cuti">站点名称</th>
                        <th class="text-center cuti">站点域名</th>
                        <th class="text-center cuti">所属平台</th>
                        <th class="text-center cuti">站点类型</th>
                        <th class="text-center cuti">状态</th>
                        <th class="text-center cuti">操作</th>
                    </tr>
                    </thead>
                    <tbody id="muchgerent"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/html" id="muchgerent_t">
    {{each data}}
    <tr class="{{$value.siteId}}">
        <td><input class="fuxk" name="choose" type="checkbox" value="{{$value.siteId}}"/>
        </td>
        <td class="text-center"> {{$value.siteName}}</td>
        <td class="text-center"> {{$value.siteDomain}}</td>
        <td class="text-center">{{$value.ptId}}</td>
        <td class="text-center">{{$value.siteType}}</td>
        <td class="text-center">{{$value.statusDesc}}</td>
        <td class="text-center caozuo">
            <a href="javascript:void(0);" data-id="{{$value.siteId}}"
               onclick="redact(this)">编辑</a>
            <a href="javascript:void(0);" data-id="{{$value.siteId}}"
               onclick="forbidden(this)">
                {{if $value.status=="1"}}
                禁用
                {{else}}
                启用
                {{/if}}
            </a>
        </td>
    </tr>
    {{/each}}
</script>

<script>
    (function (window, $) {
        let pagepost=utils_admin.clone(apidata.postdata);
        let pagepostdata={
            "header":pagepost.header,
            "payload":{
                "ptId":pagepost.payload.ptId,
            }
        };
        let pagedataone = utils_admin.setajax('POST', pagepostdata, apidata.base.queryList);
        utils_admin.queryPage("muchgerent", "muchgerent_t", pagedataone);


        //全选
        function selectall(thit) {
            let checkboxs = document.getElementsByName("choose");
            if (thit.checked) {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = true;
                }
            } else {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = false;
                }
            }
        }

        //批量禁用
        function deleteclass(a) {
            $("#popups").toggle("hidden");
            pagepostdata.payload.siteIds = utils_admin.choosevalue("muchgerent");
        }
        $("#popups>.white_content").click(function (a) {
            if (a.target.nodeName.toLowerCase() == "button") {
                $("#popups").toggle("hidden")
            }
            if (a.target.dataset.id=="1") {
                utils_admin.setajax('POST', pagepostdata, apidata.base.disableSite);
                utils_admin.queryPage("muchgerent", "muchgerent_t", utils_admin.setajax('POST',pagepostdata,apidata.base.queryList));
            }
        });
        //编辑
        function redact(e) {
            localStorage.setItem("muchaddsiteId",e.dataset.id);
            window.location.href = "/admin/views/index.html#/muchadd";
        }

        //禁用
        function forbidden(e) {
            var id = e.dataset.id;
            pagepostdata.payload.siteIds = id;
            if ($.trim($(e).text()) == "启用") {
                utils_admin.setajax('POST', pagepostdata, apidata.base.enableSite);
            } else {
                utils_admin.setajax('POST', pagepostdata, apidata.base.disableSite);
            }
            utils_admin.queryPage("muchgerent", "muchgerent_t", utils_admin.setajax('POST', pagepostdata, apidata.base.queryList));
        }

        window.redact = redact;
        window.deleteclass = deleteclass;
        window.forbidden = forbidden;
        window.selectall = selectall;
    })(window, window.$);
</script>