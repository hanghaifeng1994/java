<script src="/js/tinyImgUpload.js"></script>
{{set data=pagedata.totalData.Abilityupload}}
<div class="container">
    <div class="row">
        <div class="row mar50">
            <div class="col-xs-0 col-sm-2 col-md-2"></div>
            <div class="col-xs-2 col-sm-2 col-md-2 text-right linhei">
                才艺主题:
            </div>
            <div class="col-xs-6 col-sm-4 col-md-4">
                <input type="text" class="form-control" placeholder="" maxlength="20" minlength="1" id="abmName">
            </div>
            <div class="col-xs-4 col-sm-4 col-md-4 zifu">
                （由汉字、字母或数字组成，1-20个字符）
            </div>
        </div>
        <div class="row mar50">
            <div class="col-xs-2 col-sm-2 col-md-2"></div>
            <div class="col-xs-2 col-sm-2 col-md-2 text-right linhei">
                才艺分类:
            </div>
            <div class="col-xs-8 col-sm-8 col-md-8 ">
                <select id="province">
                    {{each data.data}}
                    <option id="{{$value.catId}}">{{$value.catName}}</option>
                    {{/each}}
                </select>
            </div>
        </div>
        <div class="row mar50">
            <div class="col-xs-0 col-sm-2 col-md-2"></div>
            <div class="col-xs-2 col-sm-2 col-md-2 text-right linhei">
                上传才艺图片:
            </div>
            <div class="col-xs-10 col-sm-8 col-md-8 zifu">
                （图片大小不超过2M，建议尺寸320*240px）
            </div>
        </div>
        <div class="row mar50">
            <div class="col-xs-0 col-sm-4 col-md-4"></div>
            <div class="col-xs-12 col-sm-8 col-md-8">
                <div id="upload"></div>
            </div>
        </div>
        <div class="row mar50">
            <div class="col-xs-0 col-sm-2 col-md-2"></div>
            <div class="col-xs-4 col-sm-2 col-md-2 text-right xuezz">
                是否同步到学习小组:
            </div>
            <div class="col-xs-8 col-sm-8 col-md-8 dif">
                <div class="radio">
                    <input type="radio" name="radio1" id="radio1" value="option1" checked>
                    <label for="radio1">
                        是
                    </label>
                </div>
                <div class="radio" style="margin-left: 60px">
                    <input type="radio" name="radio1" id="radio2" value="option2">
                    <label for="radio2">
                        否
                    </label>
                </div>
                <div class="xxxj" onclick="addquery()">
                    <a href="javascript:;">添加到学习小组……</a>
                </div>
            </div>
            <div class="col-xs-0 col-sm-1 col-md-1"></div>
        </div>
        <div hidden id="addquerypage">
            <div class="row">
                <div class="col-xs-0 col-sm-2 col-md-2"></div>
                <div class="col-xs-4 col-sm-2 col-md-2 text-right xuezz"></div>
                <div class="col-xs-12 col-sm-8 col-md-8" >
                    <div class="shey" id="addtext"></div>
                </div>
                <div class="col-xs-0 col-sm-1 col-md-1"></div>
            </div>
            <div class="row" id="addqueryheidd">
                <div class="col-xs-0 col-sm-2 col-md-2"></div>
                <div class="col-xs-4 col-sm-2 col-md-2 text-right xuezz"></div>
                <div class="col-xs-12 col-sm-8 col-md-8">
                    <div class="xuznze">
                        <div class="quanxuan">
                            <div class="checkbox checkbox-circle">
                                <input id="checkboxall" class="styled" type="checkbox" onclick="checkboxall(this)">
                                <label for="checkboxall">全选</label>
                            </div>
                            <div class="qds" onclick="addqueryheidd()">
                                <a href="javascript:;">确定</a>
                            </div>
                        </div>
                        <div class="disfll" id="addquerypagelist">

                        </div>
                    </div>
                </div>
                <div class="col-xs-0 col-sm-1 col-md-1"></div>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-11 col-sm-11 col-md-11 tijiao submit" onclick="end()">
                <a href="javascript:;">提交才艺</a>
            </div>
        </div>
        <script type="text/html" id="addquerypagelist_p">
            {{each}}
            <div class="checkbox checkbox-primary">
                <input id="{{$value}}" class="styled" type="checkbox" onclick="addchebox(this)">
                <label for="{{$value}}">
                    {{$value}}
                </label>
            </div>
            {{/each}}
        </script>
        <script type="text/html" id="addtext_p">
            {{each}}
            <span>{{$value}}</span>
            {{/each}}
        </script>
        <script type="text/html" id="province_p">
            {{each data.data}}
            <option id="{{$value.catId}}">{{$value.catName}}</option>
            {{/each}}
        </script>
        <script>
            var pageinputdata=[];
            document.documentElement.style.fontSize = document.documentElement.clientWidth * 0.1 + 'px';

            //加载分类栏目
            $("#province").onclick=function () {
                apidata.postdata.payload.showStatus ="1";
                apidata.postdata.payload.siteId ="1";
                $("#province").html(template('province_p', utils.getdata("POST", "json", apidata.album.queryPageUse, apidata.postdata)))
            };
            //全选
            function checkboxall(thit) {
                pageinputdata=[];
               var iftext=$(thit).next().text();
               if(iftext=="全选"){
                   $(thit).next().text("取消")
               }else {
                   $(thit).next().text("全选")
               }
                var addinput=$("#addquerypagelist input");
                for(var i=0;i<addinput.length;i++){
                    $(addinput[i]).prop("checked",iftext=="全选")
                  if($(addinput[i]).prop("checked")){
                      alert($(addinput[i]).attr("id"))
                      pageinputdata.push($(addinput[i]).attr("id"));
                  }
                }
                temppage();
            }

            //选择
            function addchebox(that) {
                if($(that).prop("checked")){
                    pageinputdata.push($(that).attr("id"))
                }else {
                    pageinputdata.remove($(that).attr("id"));
                }
                temppage()
            }

            //已选择的内容
            function temppage() {
                var inputtemparr=[];
                for(var i=0;i<pageinputdata.length;i++){
                    inputtemparr.push($("#"+pageinputdata[i]+"").next().text())
                }
                $("#addtext").html(template("addtext_p",inputtemparr))
            }
            //新增小组
            function addquery() {
                $("#addquerypage").prop("hidden", false);
                $("#addqueryheidd").prop("hidden", false);
                apidata.postdata.payload.catId = "07e9bf3cb6914c29b7b8fa5cd6f981d0";
                $("#addquerypagelist").html(template('addquerypagelist_p', utils.getdata("POST", "json", apidata.studygrou.queryPageUse, apidata.postdata)))
            }

            //确定
            function addqueryheidd() {
                $("#addqueryheidd").prop("hidden", true);
            }

            var phId=''

            var options = {
                path:apidata.album.phsave,
                onSuccess: function (res,id) {
                    console.log(res,phId);
                },
                onFailure: function (res,id) {
                    console.log(res,phId);
                }
            };
            var upload = tinyImgUpload('#upload',options);
            //上传
            function end() {
                if($("#abmName").val()){
                    apidata.postdata.payload.abmName=$("#abmName").val();
                    apidata.postdata.payload.catId= $("#province").val();
                    phId=utils.getdata("POST","json", apidata.album.asave,apidata.postdata);
                    upload();
                }else {
                    console.log("才艺主题")
                }
            }
        </script>
    </div>
</div>