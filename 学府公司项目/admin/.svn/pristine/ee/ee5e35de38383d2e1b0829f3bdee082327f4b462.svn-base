
<div style="padding-top:13px">
    <div class="col-md-12">
        <div class="card horizontal-form">
            <div class="card-body ">
                <div class="row col-md-12">
                    <div class="col-md-4 col-sm-6">
                        <div class="row">
                            <label class="col-md-4 control-label">角色名称</label>
                            <div class="col-md-7">
                                <input type="text" class="form-control">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 mr-auto ml-auto">
                        <button  class="btn btn-wd btn-e" onclick="seek(this)">搜索</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-12">
        <div class="padding-l-10 f-s-17 bod  box-s bod-r-8 padding-t-10">
            <a class="btn  btn-wd btn-e" href="#/adduserrole">创建角色</a>
            <button class="btn  btn-wd btn-f" onclick="deleteclass()">批量删除</button>
        </div>
    </div>

    <div class="container-fluid padding-t-20">
        <div class="row">
            <div class="col-md-12 ">
                <table class="table table-bordered table-hover" id="tablecz">
                    <thead>
                    <tr>
                        <th><input class="fuxk" name="allcheck" type="checkbox" value="" id="allcheck" onclick="selectall()"/></th>
                        <th class="text-center cuti">角色名称</th>
                        <th class="text-center cuti">操作</th>
                    </tr>
                    </thead>
                    <tbody id="userrole"></tbody>

                </table>
                <div class="fenye">
                    <div class="pagination pagination0"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/html" id="userrole_t">
    {{each data}}
    <tr class="{{$value.roleId}}">
        <td><input class="fuxk" name="choose" type="checkbox" value="{{$value.roleId}}"/>
        </td>
        <td class="text-center"> {{$value.roleName}}</td>
        <td class="text-center caozuo">
            <a href="javascript:void(0);" data-id="{{$value.roleId}}" onclick="redact(this)">编辑</a>
            <a href="javascript:void(0);" data-id="{{$value.roleId}}" onclick="onedel(this)">删除</a>
        </td>
    </tr>
    {{/each}}
</script>


<script>
    (function (window, $) {
        var pagepostdata=apidata.postdata;
        //列表1  修改查询接口-apidata.news.queryPage
        let pagedataone = utils_admin.setajax('POST', pagepostdata, apidata.base.queryPage);
        utils_admin.queryPage("userrole", "userrole_t", pagedataone);
        //分页1
        new pagination({
            pagination: $('.pagination0'),//分页挂载的样式名称
            maxPage: 5, //最大页码数,支持奇数，左右对称
            startPage: 1,    //默认第一页
            currentPage: 1,          //当前页码
            totalPageCount: (pagedataone.totalCount / pagedataone.pageSize) - (pagedataone.totalCount / pagedataone.pageSize) % 1 + 1,
            callback: function (pageNum) {
                pagepostdata.payload.page = "" + pageNum + "";
                //修改查询接口-apidata.news.queryPage
                utils_admin.queryPage("userrole", "userrole_t", utils_admin.setajax('POST', pagepostdata, apidata.base.queryPage));
            }
        });


        //全选
        function selectall(thit) {
            let checkboxs = document.getElementsByName("choose");
            if (thit.checked) {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = true;
                }
            } else {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = false;
                }
            }
        }

        //搜索
        function seek(e) {
            let inputdata = $("input[type=text]");
            pagepostdata.payload.loginName = inputdata[0].value;
            pagepostdata.payload.custName = inputdata[1].value;
            pagepostdata.payload.office = inputdata[2].value;
            utils_admin.queryPage("usernumber", "usernumber_t", utils_admin.setajax('POST', pagepostdata, apidata.base.queryPage));
        }
        //编辑
        function redact(e) {
            utils_admin.redact("adduserrole", "roleId", e)
        }
        ///删除
        function onedel(e) {
            var id = e.dataset.id;
            pagepostdata.payload.custIds = id;
            $("#popups").toggle("hidden");
        }
        //批量删除
        function deleteclass(a) {
            $("#popups").toggle("hidden");
            pagepostdata.payload.custIds=choosevalue("usernumber");
        }
        $("#popups>.white_content").click(function (a) {
            if (a.target.nodeName.toLowerCase() == "button") {
                $("#popups").toggle("hidden")
            }
            if(a.target.dataset.id){
                utils_admin.setajax('POST', pagepostdata, apidata.base.freezeUser);
                utils_admin.queryPage("usernumber", "usernumber_t", utils_admin.setajax('POST', pagepostdata, apidata.base.queryPage));
            }
        });

        window.onedel=onedel;
        window.selectall=selectall;
        window.seek=seek;
    })(window, window.$);
</script>
