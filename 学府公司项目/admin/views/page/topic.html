<div class="card-body">
    <div class="tab-content">
        <div class="col-md-12 row" style="padding-top: 10px">
            <div class="col-md-6 col-xs-12 row">
                <div class="col-md-4 col-xs-12">
                    <div class="parentsitelist"></div>
                </div>
                <div class="col-md-4 col-xs-12" style="margin-left: 50px">
                    <div class="endchild"></div>
                </div>
            </div>
            <div class="col-md-6 col-xs-12 row ">
                <div class="col-md-12 col-xs-12">
                    <button class="btn btn-e btn-wd" onclick="deleteclass(this)">批量删除</button>
                    <a class="btn btn-e btn-wd" href="#/addquestiongerent">题目上传</a>
                </div>
            </div>
        </div>
        <div class="container-fluid padding-t-20">
            <div class="row">
                <div class="col-md-12 ">
                    <table class="table table-bordered table-hover" id="tablecz">
                        <thead>
                        <th><input class="fuxk" name="allcheck" type="checkbox" value="" id="allcheck"
                                   onclick="selectall(this)"/></th>
                        <th class="text-center cuti">题干内容</th>
                        <th class="text-center cuti">题型</th>
                        <th class="text-center cuti">发布状态</th>
                        <th class="text-center cuti">操作</th>
                        </thead>
                        <tbody id="topic"></tbody>
                    </table>
                    <div class="fenye">
                        <div class="pagination pagination0"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id="topic_t">
    {{each data}}
    <tr class="{{$value.questionId}}">
        <td><input class="fuxk" name="choose" type="checkbox" value="{{$value.questionId}}"/>
        </td>
        <td class="text-center">{{$value.stemContent}}</td>
        <td class="text-center">
            {{if $value.itemTypeId=='dx'}}
            单选
            {{else if $value.itemTypeId=='ms'}}
            多选
            {{else if $value.itemTypeId=='pd'}}
            判断
            {{else if $value.itemTypeId=='tk'}}
            题空
            {{/if}}
        </td>
        <td class="text-center">
            {{if $value.itemPubStatus==0}}未发布
            {{else if $value.itemPubStatus==1}}已发布
            {{/if}}
        </td>
        <td class="text-center caozuo">
            <a href="javascript:void(0);" data-id="{{$value.questionId}}"
               onclick="check(this)">
                编辑</a>
            <a href="javascript:void(0);" data-id="{{$value.questionId}}"
               onclick="onedel(this)">删除</a>
        </td>
    </tr>
    {{/each}}
</script>

<script>
    (function (window, $) {
        utils_admin.delpostdata("questionId")
        let pagepostdata = utils_admin.clone(apidata.postdata);
        let pagedataone = utils_admin.setajax('POST', pagepostdata, apidata.testing.queryPageExt);
        utils_admin.queryPage("topic", "topic_t", pagedataone);
        //分页1
        new pagination({
            pagination: $('.pagination0'),
            maxPage: 5, //最大页码数,支持奇数，左右对称
            startPage: 1,    //默认第一页
            currentPage: 1,          //当前页码
            totalPageCount: (pagedataone.totalCount / pagedataone.pageSize) - (pagedataone.totalCount / pagedataone.pageSize) % 1 + 1,  //总页数
            callback: function (pageNum) {
                pagepostdata.payload.page = "" + pageNum + "";
                utils_admin.queryPage("topic", "topic_t", utils_admin.setajax('POST', pagepostdata, apidata.testing.queryPageExt));
            }
        });


        //编辑
        function check(e) {
            utils_admin.redact("addquestiongerent", "questionId", e)
        }

        //全选
        function selectall(thit) {
            let checkboxs = document.getElementsByName("choose");
            if (thit.checked) {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = true;
                }
            } else {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = false;
                }
            }
        }

        //删除
        function onedel(e) {
            $("#popups").toggle("hidden");
            var id = e.dataset.id;
            pagepostdata.payload.questionId = id;
        }

        //批量删除
        function deleteclass(a) {
            $("#popups").toggle("hidden");
            pagepostdata.payload.questionId = utils_admin.choosevalue("topic");
        }

        $("#popups>.white_content").off('click').on('click', function (a) {
            if (a.target.nodeName.toLowerCase() == "button") {
                $("#popups").toggle("hidden")
            }
            if (a.target.dataset.id == "1") {
                utils_admin.setajax('POST', pagepostdata, apidata.testing.deletetest);
                utils_admin.queryPage("topic", "topic_t", utils_admin.setajax('POST', pagepostdata, apidata.testing.queryPageExt));
            }
            a.stopPropagation();
        });
        window.selectall = selectall
        window.onedel = onedel;
        window.deleteclass = deleteclass
        window.check = check
    })(window, window.$);
</script>