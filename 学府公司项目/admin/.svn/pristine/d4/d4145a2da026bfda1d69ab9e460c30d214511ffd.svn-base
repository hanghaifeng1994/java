<div class="col-md-12">
    <div class="horizontal-form">
        <div class="card-body">
            <div class="form-group col-xl-12 padding-t-10">
                <div class="row">
                    <label class="col-md-2 control-label brokeragetime"></label>
                    <div class="col-md-10 row rylist">
                        <div class="col-md-4">
                            <div class="parentsitelist "></div>
                        </div>
                        <div class="col-md-4">
                            <div class="endchild "></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group col-xl-12 padding-t-10">
                <div class="row">
                    <label class="col-md-2 control-label brokeragetime">所属证书</label>
                    <div class="col-md-4">
                        <input type="text" placeholder="" class="form-control">
                    </div>
                </div>
            </div>
            <br>
            <div class="col-xl-12 col-sm-12 col-md-12 linexian">
                <h4>
                    组卷设置
                </h4>
            </div>
            <div class="form-group col-xl-12 padding-t-10">
                <div class="row">
                    <label class="col-md-2 control-label brokeragetime">试卷主题</label>
                    <div class="col-md-4">
                        <input type="text" placeholder="" class="form-control">
                    </div>
                </div>
            </div>
            <div class="form-group col-xl-12 padding-t-10">
                <div class="row">
                    <label class="col-md-2 control-label brokeragetime">总分</label>
                    <div class="col-md-4">
                        <input type="text" placeholder="" class="form-control">
                    </div>
                </div>
            </div>
            <div class="form-group col-xl-12 padding-t-10" id="test">

            </div>

            <div class="form-group col-xl-12 padding-t-10">
                <div class='row' style="padding-top: 40px">
                    <label class="col-md-4 control-label brokeragetime padding-t-20"></label>
                    <button class="btn btn-e col-md-2" onclick="addanswer()">增加题型</button>
                </div>
            </div>
            <div class="form-group col-xl-12 padding-t-10">
                <div class="row">
                    <label class="col-md-2 control-label brokeragetime">题目乱序</label>
                    <div class="col-md-4">
                        <div class="sequence"></div>
                    </div>
                </div>
            </div>
            <div class="form-group col-xl-12 padding-t-10">
                <div class="row">
                    <label class="col-md-2 control-label brokeragetime">选项乱序</label>
                    <div class="col-md-4">
                        <div class="option"></div>
                    </div>
                </div>
            </div>
            <br/>
            <br/>
            <div class="form-group col-xl-12 padding-t-20">
                <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-fill  btn-e">确定</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script type="text/html" id="test_t">
    <% for(var i = 1; i < data+1; i++){ %>
    <div class="row padding-t-10">
    <div class="col-md-2">
        <select name="cities" class="selectpicker" data-title="单选题" data-style=" btn-fill btn-block" data-menu-style="dropdown-blue">
            <option value="1">单选题</option>
            <option value="2">多选题</option>
        </select>
    </div>
        <label class="col-md-2 control-label brokeragetime">试题知识点</label>
        <div class="col-md-2">
            <select multiple data-title="知识点" name="currency" class="selectpicker" data-style=" btn-fill btn-block"
                    data-menu-style="dropdown-blue">
                <option value="ARS">ARS</option>
                <option value="SEK">SEK</option>
                <option value="SGD">SGD</option>
                <option value="TWD">TWD</option>
                <option value="USD">USD</option>
                <option value="VND">VND</option>
                <option value="ZAR">ZAR</option>
            </select>
        </div>
        <label class="col-md-2 control-label brokeragetime">试题数量</label>
        <input type="text" placeholder="" class="form-control col-md-1">
        <label class="col-md-2 control-label brokeragetime">每题分值</label>
        <input type="text" placeholder="" class="form-control col-md-1">
    </div>
    <% } %>
</script>
<script>
    (function () {
        var pagepostdata = apidata.postdata;
        //站点,平台初始化
        window.utils_admin.loadhtml($(".parentsitelist"), '/dropdown.html', {
            "header": "所有平台",
            "id": null,
            "body": window.parentSiteList,
            "width": 120,
            "name": "parentsitelist",
        });
        window.utils_admin.loadhtml($(".endchild"), '/dropdown.html', {
            "header": "先选择平台",
            "id": null,
            "body": null,
            "width": 120,
            "name": "endchild",
        });
        //换站点
        $(".parentsitelist").click(function (a) {
            let id = '', endchild = [];
            if (a.target.nodeName.toLowerCase() == "li") {
                id = a.target.getAttribute("id")
            } else {
                id = window.parentSiteList[0].id
            }
            window.childSiteList.forEach((a) => {
                a.forEach((e, index) => {
                    if (e.ptId == id) {
                        endchild.push(e)
                        endchild[index].text = endchild[index].siteName;
                        endchild[index].id = endchild[index].siteId;
                    }
                })
            });
            window.utils_admin.loadhtml($(".endchild"), '/dropdown.html', {
                "header": endchild[0].text,
                "id": endchild[0].id,
                "body": endchild,
                "width": 120,
                "name": "endchild",
            });
        });
        $(".endchild").click(function (a) {
            pagepostdata.payload.siteId = utils_admin.downid(a, "endchild");
        });

        //题目乱序
        window.utils_admin.loadhtml($(".sequence"), '/dropdown.html', {
            "header": "题目不乱序",
            "id": "1",
            "body": [
                {
                    "text": "题目不乱序",
                    "id": "1"
                },
                {
                    "text": "题目乱序",
                    "id": "2"
                }
            ],
            "width": 140,
            "name": "sequence",
        });
        //选项乱序
        window.utils_admin.loadhtml($(".option"), '/dropdown.html', {
            "header": "选项不乱序",
            "id": "1",
            "body": [
                {
                    "text": "选项不乱序",
                    "id": "1"
                },
                {
                    "text": "选项乱序",
                    "id": "2"
                }
            ],
            "width": 140,
            "name": "option",
        });

        //初始化第一个题型
        $("#test").append(template("test_t", {
            data: 1
        }));
        //知识点
        $('.selectpicker').selectpicker({'selectedText': 'cat'});
        //题型
        window.utils_admin.loadhtml($(".choose"), '/dropdown.html', {
            "name": "choose",
            "header": "单选题",
            "id": "1",
            "width": "130",
            "body": [
                {
                    "text": "单选题",
                    "id": "1"
                },
                {
                    "text": "多选题",
                    "id": "2"
                }
            ]
        });

        var html = $("#test").html()

        //新增题目
        function addanswer() {

            $("#test").append(html);

        }

        window.utils_admin.loadhtml($(".downtest"), '/dropdown.html', {
            "header": "所有平台",
            "id": null,
            "body": window.parentSiteList,
            "width": 120,
            "name": "downtest",
        });

        window.addanswer = addanswer;
    })(window)
</script>