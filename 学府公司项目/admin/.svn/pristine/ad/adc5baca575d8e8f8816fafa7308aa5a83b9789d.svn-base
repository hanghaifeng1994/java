<div class="card-body">
    <div class="tab-content">
        <div class="col-md-12 row" style="padding-top: 10px">
            <div class="col-md-6 col-xs-12 row">
                <div class="col-md-4 col-xs-12">
                    <div class="parentsitelist"></div>
                </div>
                <div class="col-md-4 col-xs-12" style="margin-left: 50px">
                    <div class="endchild"></div>
                </div>
            </div>
            <div class="col-md-6 col-xs-12 row ">
                <div class="col-md-12 col-xs-12">
                    <button class="btn btn-e btn-wd" onclick="deleteclass()">题目上传</button>
                    <a class="btn btn-e btn-wd" href="">批量删除</a>
                </div>
            </div>
        </div>
        <div class="container-fluid padding-t-20">
            <div class="row">
                <div class="col-md-12 ">
                    <table class="table table-bordered table-hover" id="tablecz">
                        <thead>
                        <th><input class="fuxk" name="allcheck" type="checkbox" value="" id="allcheck"
                                   onclick="selectall()"/></th>
                        <th class="text-center cuti">试题编号</th>
                        <th class="text-center cuti">题干内容</th>
                        <th class="text-center cuti">题型</th>
                        <th class="text-center cuti">知识点</th>
                        <th class="text-center cuti">操作</th>
                        </tr>
                        </thead>



                        <tbody id="resultgecolumn"></tbody>



                    </table>
                    <div class="fenye">
                        <div class="pagination pagination0"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/html" id="resultgecolumn_t">
    {{each data}}
    <tr class="{{$value.questionId}}">
        <td><input class="fuxk" name="choose" type="checkbox" value="{{$value.questionId}}"/>
        </td>
        <td class="text-center"> {{$value.qpId}}</td>
        <td class="text-center">{{$value.stemContent}}</td>
        <td class="text-center">{{$value.itemTypeId}}</td>
        <td class="text-center">{{$value.sectionId}}</td>
        <!--改第一个tab表格抬头对应数据结束-->
        <!--单行操作区-根据具体页面选择对应按钮修，不需要的注释-->
        <td class="text-center caozuo">
            <a href="javascript:void(0);"  data-status="{{$value.rstStatus}}" data-id="{{$value.questionId}}"
               onclick="actStatus(this)">
                {{if $value.rstStatus=="1"}}审核
                {{else if $value.itemPubStatus=="1" || $value.itemPubStatus !=""}}提交审核
                {{/if}}</a>
            <a href="javascript:void(0);" data-id="{{$value.questionId}}"
               onclick="view(this)">
                预览</a>
            <a href="javascript:void(0);" data-type="now" data-id="{{$value.questionId}}"
               onclick="deleteById(this)">{{if $value.itemPubStatus=="0"||$value.itemPubStatus=="" }}删除{{/if}}</a>
        </td>
    </tr>
    {{/each}}
</script>
<script>


    (function (window, $) {
        var pagepostdata = apidata.postdata;
        //列表1  修改查询接口-apidata.news.queryPage
        let pagedataone = utils_admin.setajax('POST', apidata.postdata, apidata.testing.queryPageExt);
        console.log("data", pagedataone)
        utils_admin.queryPage("queryPage", "queryPage_t", pagedataone);
        //分页1
        new pagination({
            pagination: $('.pagination0'),//分页挂载的样式名称
            maxPage: 5, //最大页码数,支持奇数，左右对称
            startPage: 1,    //默认第一页
            currentPage: 1,          //当前页码
            totalPageCount: pagedataone.pageSize,  //总页数
            callback: function (pageNum) {
                apidata.postdata.payload.page = "" + pageNum + "";
                //修改查询接口-apidata.news.queryPage
                utils_admin.queryPage("queryPage", "queryPage_t", utils_admin.setajax('POST', apidata.postdata, apidata.testing.queryPageExt));
            }
        });






        window.utils_admin.calendar($('.datepicker'));

        //站点,平台初始化
        window.utils_admin.loadhtml($(".parentsitelist"), '/dropdown.html', {
            "header": "所有平台",
            "id": null,
            "body": window.parentSiteList,
            "width": 120,
            "name": "parentsitelist",
        });
        window.utils_admin.loadhtml($(".endchild"), '/dropdown.html', {
            "header": "先选择平台",
            "id": null,
            "body": null,
            "width": 120,
            "name": "endchild",
        });
        //换站点
        $(".parentsitelist").click(function (a) {
            let id = '', endchild = [];
            if (a.target.nodeName.toLowerCase() == "li") {
                id = a.target.getAttribute("id")
            } else {
                id = window.parentSiteList[0].id
            }
            window.childSiteList.forEach((a) => {
                a.forEach((e, index) => {
                    if (e.ptId == id) {
                        endchild.push(e)
                        endchild[index].text = endchild[index].siteName;
                        endchild[index].id = endchild[index].siteId;
                    }
                })
            });
            window.utils_admin.loadhtml($(".endchild"), '/dropdown.html', {
                "header": endchild[0].text,
                "id": endchild[0].id,
                "body": endchild,
                "width": 120,
                "name": "endchild",
            });
        });
        $(".endchild").click(function (a) {
            if (a.target.nodeName.toLowerCase() == "li") {
                id = a.target.getAttribute("id")
            } else {
                id = $(".endchild")[0].id
            }
            pagepostdata.payload.siteId = id;
        });

        //栏目一初始化-修改不同页面的具体分类接口- apidata.news.newsCategoryqueryPage)
        let newscategoryone = utils_admin.setajax('POST', apidata.postdata, apidata.news.newsCategoryqueryPage);
        console.log("newscategoryone--", newscategoryone)
        let newscategoryonearr = [];
        newscategoryone.data.forEach((a) => {
            a.text = a.catName;
            a.id = a.catId
            newscategoryonearr.push(a)
        });
        window.utils_admin.loadhtml($(".newscategoryone"), '/dropdown.html', {
            "header": "栏目一",
            "id": null,
            "body": newscategoryonearr,
            "width": 135,
            "name": "newscategoryonearr",
        });
        //换栏目
        $(".newscategoryone").click(function (a) {
            let id = '', endchild = [];
            if (a.target.nodeName.toLowerCase() == "li") {
                id = a.target.getAttribute("id")
            } else {
                id = ""
            }
            apidata.postdata.payload.parentId = id;
            //修改不同页面的具体分类接口
            let newscategorytwo = utils_admin.setajax('POST', apidata.postdata, apidata.news.newsCategoryqueryPage);
            console.log(newscategorytwo)
            if (newscategorytwo.data) {
                newscategorytwo.data.forEach((a) => {
                    endchild.push(a)
                    endchild[index].text = endchild[index].siteName;
                    endchild[index].id = endchild[index].catId;
                })
            } else {
                endchild[0].text = "空"
            }
            window.utils_admin.loadhtml($(".newscategorytwo"), '/dropdown.html', {
                "header": endchild[0].text,
                "id": endchild[0].id,
                "body": endchild,
                "width": 120,
                "name": "newscategorytwo",
            });
        })
        window.utils_admin.loadhtml($(".newscategorytwo"), '/dropdown.html', {
            "header": "栏目二",
            "id": null,
            "body": null,
            "width": 120,
            "name": "newscategorytwo",
        });
        //如果没有此搜索条件，即可删除
        window.utils_admin.loadhtml($(".statusstate"), '/dropdown.html', {
            "header": "所有",
            "id": null,
            "body": [
                {
                    "text": "未提交",
                    "id": "1"
                },
                {
                    "text": "提交",
                    "id": "2"
                },
            ],
            "width": 120,
            "name": "statusstate",
        });
        //如果没有此搜索条件，即可删除
        window.utils_admin.loadhtml($(".stickstate"), '/dropdown.html', {
            "header": "所有",
            "id": null,
            "body": [
                {
                    "text": "置顶",
                    "id": "1"
                },
                {
                    "text": "未置顶",
                    "id": "2"
                },
            ],
            "width": 120,
            "name": "stickstate",
        });

        //主站下发资讯的栏目-不用考虑
        window.utils_admin.loadhtml($(".companynewscateone"), '/dropdown.html', {
            "heard": "栏目一",
            "id": null,
            "body": [
                {
                    "text": "置顶",
                    "id": "1"
                },
                {
                    "text": "未置顶",
                    "id": "2"
                },
            ],
            "width": 120,
            "name": "companynewscateone",
        });
        //主站下发资讯的审核状态-不用考虑
        window.utils_admin.loadhtml($(".companynewscatetwo"), '/dropdown.html', {
            "heard": "栏目二",
            "id": null,
            "body": [
                {
                    "text": "置顶",
                    "id": "1"
                },
                {
                    "text": "未置顶",
                    "id": "2"
                },
            ],
            "width": 120,
            "name": "companynewscatetwo",
        });
        //主站下发资讯的审核状态-不用考虑
        window.utils_admin.loadhtml($(".all"), '/dropdown.html', {
            "heard": "全部",
            "id": "0",
            "body": [
                {
                    "text": "未抓取",
                    "id": "1"
                },
                {
                    "text": "已抓取",
                    "id": "2"
                },
            ],
            "width": 120,
            "name": "all",
        });

        //搜索
        function seek(e) {
            let inputdata = $("input[type=text]");
            pagepostdata.payload.loginName = inputdata[0].value;
            pagepostdata.payload.custName = inputdata[1].value;
            pagepostdata.payload.office = inputdata[2].value;
            utils_admin.queryPage("usernumber", "usernumber_t", utils_admin.setajax('POST', pagepostdata, apidata.base.queryStaffPage));
        }

        //全选
        function selectall(thit) {
            let checkboxs = document.getElementsByName("choose");
            if (thit.checked) {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = true;
                }
            } else {
                for (let i = 0; i < checkboxs.length; i++) {
                    let e = checkboxs[i];
                    e.checked = false;
                }
            }
        }

        //查看
        function redact(e) {
            utils_admin.redact("addmessagegerent", "articleId", e)
        }

        ///删除
        function onedel(e) {
            var id = e.dataset.id;
            pagepostdata.payload.custIds = id;
            $("#popups").toggle("hidden");
        }

        //批量删除
        function deleteclass(a) {
            $("#popups").toggle("hidden");
            pagepostdata.payload.custIds = choosevalue("usernumber");
        }

        $("#popups>.white_content").click(function (a) {
            if (a.target.nodeName.toLowerCase() == "button") {
                $("#popups").toggle("hidden")
            }
            if (a.target.dataset.id) {
                utils_admin.setajax('POST', pagepostdata, apidata.base.freezeUser);
                utils_admin.queryPage("usernumber", "usernumber_t", utils_admin.setajax('POST', pagepostdata, apidata.base.staffPtSitesListOne));
            }
        });

        //禁用
        function forbidden(e) {
            var id = e.dataset.id;
            pagepostdata.payload.custIds = id;
            if ($.trim($(e).text()) == "启用") {
                utils_admin.setajax('POST', pagepostdata, apidata.base.enableUser);
            } else {
                utils_admin.setajax('POST', pagepostdata, apidata.base.freezeUser);
            }
            utils_admin.queryPage("usernumber", "usernumber_t", utils_admin.setajax('POST', pagepostdata, apidata.base.staffPtSitesListOne));
        }

        function gettopic(e) {
            utils_admin.redact("questionId", "topic", e)
        }
        window.gettopic=gettopic;

        window.onedel = onedel;
        window.deleteclass = deleteclass;
        window.redact = redact;
        window.forbidden = forbidden;
        window.selectall = selectall;
        window.seek = seek;

    })(window, window.$);



    (function (window) {
        var pagepostdata=utils_admin.clone(apidata.postdata);
        var pagedata = utils_admin.setajax('POST', apidata.postdata, apidata.activity.actResultPage);
        console.log(pagedata)
        utils_admin.queryPage("resultgecolumn", "resultgecolumn_t", pagedata);
        new pagination({
            pagination: $('.pagination0'),//分页挂载的样式名称
            maxPage: 5, //最大页码数,支持奇数，左右对称
            startPage: 1,    //默认第一页
            currentPage: 1,          //当前页码
            totalPageCount: (pagedata.totalCount / pagedata.pageSize) - (pagedata.totalCount / pagedata.pageSize) % 1 + 1,  //总页数
            callback: function (pageNum) {
                apidata.postdata.payload.page = "" + pageNum + "";
                //修改查询接口-apidata.news.queryPage
                utils_admin.queryPage("resultgecolumn", "resultgecolumn_t", utils_admin.setajax('POST', apidata.postdata, apidata.activity.actResultPage));
            }
        });
        //删除成果
        function deleteById(e){
            var id= $(e).attr("data-id");
            pagepostdata.payload.rstId=id;
            utils_admin.setajax('POST', pagepostdata, apidata.activity.actResultDelete);
            utils_admin.queryPage("resultgecolumn", "resultgecolumn_t", utils_admin.setajax('POST', apidata.postdata, apidata.activity.actResultPage));
        }
    })(window)

</script>